<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Home</title>
  <link rel="stylesheet" href="../css/home.css">
</head>
<body>

  <!-- Sidebar -->
  <aside id="sidebar" class="sidebar">
    <button class="close-btn" onclick="closeSidebar()">√ó</button>
    <a href="#">Inicio</a>
    <a href="#">Favoritos</a>
    <a href="#">Configuraci√≥n</a>
  </aside>

  <!-- Contenido principal -->
  <div id="main">
    <header class="topbar">
      <button class="menu-btn" onclick="openSidebar()">‚ò∞</button>
      <h1 id="bienvenida">Bienvenid@</h1>
    </header>

    <!-- Secci√≥n superior con cajitas -->
<section class="plantillas" id="plantillas">
  <!-- Primera cajita fija para crear nueva colecci√≥n -->
  <div class="plantilla nueva-coleccion">
    <span class="icon">‚ûï</span>
    <a href="generar_sets.html">Crear nueva colecci√≥n</a>
  </div>
  <!-- Cajitas de colecciones din√°micas se agregan con JS -->
</section>

<!-- Bot√≥n para crear nueva colecci√≥n afuera de la grilla -->
<div class="crear-coleccion-boton">
  <button onclick="window.location.href='generar_sets.html'">+ Nueva Colecci√≥n</button>
</div>

<!-- Secci√≥n inferior (tabla/cuadrilla) -->
<section class="tableros">
  <h2>Tus Colecciones</h2>
  <table>
    <thead>
      <tr>
        <th>Nombre</th>
        <th>Categoria</th>
        <th>Abierto por √∫ltima vez</th>
      </tr>
    </thead>
    <tbody id="colecciones-body">
      <!-- Se llenar√° din√°micamente desde JS -->
    </tbody>
  </table>
</section>


  <script>
    // Mostrar nombre de usuario
     const usuario = localStorage.getItem('usuarioActual');
     const bienvenida = document.getElementById('bienvenida');

      if (usuario && bienvenida) {
        bienvenida.textContent = `¬°Bienvenid@, ${usuario}!`;
     }

    // Abrir y cerrar sidebar
    function openSidebar() {
      document.getElementById("sidebar").style.width = "250px";
      document.getElementById("main").style.marginLeft = "250px";
    }
    function closeSidebar() {
      document.getElementById("sidebar").style.width = "0";
      document.getElementById("main").style.marginLeft = "0";
    }

    // ---- Manejo de cajitas din√°micas ----
    const plantillas = document.getElementById("plantillas");

    function cargarCajitas() {
      // Elimina las cajitas din√°micas existentes (no la primera)
      plantillas.querySelectorAll(".plantilla.dynamic").forEach(c => c.remove());

      const colecciones = JSON.parse(localStorage.getItem("colecciones")) || [];

      colecciones.forEach(c => {
        const div = document.createElement("div");
        div.className = "plantilla dynamic";
        div.onclick = () => {
          // Abrir colecci√≥n (puedes redirigir o mostrar alerta)
          alert(`Abriste la colecci√≥n: ${c.nombre}`);
        };
        div.innerHTML = `<span class="icon">üìÑ</span><p>${c.nombre}</p>`;
        plantillas.appendChild(div);
      });
    }

    // ---- Manejo de tabla de colecciones ----
    const bodyTabla = document.getElementById("colecciones-body");

    function cargarTabla() {
      bodyTabla.innerHTML = ""; // Limpiar tabla
      const colecciones = JSON.parse(localStorage.getItem("colecciones")) || [];

      if (colecciones.length === 0) {
        const tr = document.createElement("tr");
        tr.innerHTML = `<td colspan="3" style="text-align:center; color: #888;">No tienes colecciones a√∫n</td>`;
        bodyTabla.appendChild(tr);
      } else {
        colecciones.forEach(c => {
          const tr = document.createElement("tr");
          tr.innerHTML = `
            <td><strong>${c.nombre}</strong><br><small>Modificado por ${c.usuario},</td>
            <td>${c.categoria || "-"}</td>
            <td>${c.ultimoAcceso || "-"}, ${c.fecha}</small></td>
          `;
          bodyTabla.appendChild(tr);
        });
      }
    }

    // Cargar todo al inicio
    cargarCajitas();
    cargarTabla();
  </script>

</body>
</html>
